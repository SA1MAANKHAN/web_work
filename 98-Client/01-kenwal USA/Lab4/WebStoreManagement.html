<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <!-- loading js  -->
    <link rel="stylesheet" href="./css/WebStoreManager.css" />
    <script type="text/javascript" src="js/model.js"></script>
    <title>WebStoreManagement</title>
  </head>
  <body>
    <div class="page__heading">
      <h1>Store Management</h1>
    </div>
    <div class="nav">
      <a class="nav__link" href="./WebStore.html"> <h1>Go Back to site</h1></a>
      <a class="nav__link" href="./Order.html"><h1>Go to Orders</h1></a>
    </div>
    <div class="form__container">
      <form class="newItem form">
        <h2>Add or Modify Products</h2>

        <label class="form__label" for="">Name of Item:</label>

        <input required class="newItem__name" type="text" />

        <label class="form__label" for="">Price:</label>
        <input required class="newItem__price" type="number" />

        <label class="form__label" for="">Image Url:</label>
        <input
          required
          class="newItem__image"
          placeholder="default.jpg"
          type="text"
        />

        <label class="form__label" for="">Units:</label>
        <input required class="newItem__units" type="text" />

        <label class="form__label" for="">Description:</label>
        <input required class="newItem__description" type="text" />

        <label class="form__label" for="">Select a Category:</label>
        <select
          required
          id="category"
          class="newItem__category"
          name="category"
          size="3"
        >
          <option value="coffee">Coffee</option>
          <option value="tea">Tea</option>
          <option value="pastries">Pastries</option>
        </select>
        <button class="newItem__btn btn">Add</button>
      </form>

      <!-- <form class="modify">
      <h2>Modify Products</h2>
      <label for="">Name:</label>
      <input required class="modify__name" type="text" />

      <button class="modify__btn">Modify</button>
    </form> -->

      <form class="delete form">
        <h2>Delete Products</h2>
        <label for="">Name of item:</label>
        <input required class="delete__name" type="text" />

        <button class="delete__btn btn">Delete</button>
      </form>
    </div>
    <div class="items__container">
      <h2 class="items__heading">Menu Items</h2>
    </div>
    <div class="orders__container">
      <h2 class="orders__heading">Previous Orders</h2>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <div class="orderItem__info"></div>

    <script>
      $(document).ready(function () {
        // to display orders
        var allOrders = JSON.parse(localStorage.getItem("orders"));
        for (var order in allOrders) {
          // $(".items__heading").

          for (var orderItem in allOrders[order])
            $(`
              <div class="orderItem__info">
                <h3>${orderItem}: </h3>
                <h3>${allOrders[order][orderItem]} </h3>
                </div>
        `).insertAfter($(".orders__heading"));

          $(` <h1>${order}'s Order</h1>`).insertAfter($(".orders__heading"));
          $(` <h1>------------------------------</h1>`).insertAfter(
            $(".orders__heading")
          );
        }

        // to display items
        var products = JSON.parse(localStorage.getItem("productDetails"));
        for (var product in products) {
          // $(".items__heading").
          if (products[product].name == "Tax") {
            continue;
          }
          $(`

            <div class="menu__item">
            <img class="item__img" src=${
              "./img/" + products[product].image
            } alt="">

              <h2>${products[product].name}</h2>
              <h3>${products[product].price}$</h3>
        <p>${products[product].category}</p>
        </div>
        `).insertAfter($(".items__heading"));
        }

        // to add new items
        $(".newItem__btn").click(function (e) {
          // e.preventDefault();
          console.log("Click");

          name = $(".newItem__name").val();
          price = $(".newItem__price").val();
          image = $(".newItem__image").val();
          category = $(".newItem__category").val();
          description = $(".newItem__description").val();
          units = $(".newItem__units").val();

          // console.log(newItem);
          console.log(
            addNewItems(name, image, description, units, price, category)
          );
        });

        $(".delete__btn").click(function (e) {
          // e.preventDefault();
          console.log("Click");

          name = $(".delete__name").val();

          console.log(name);

          const storage = JSON.parse(localStorage.getItem("productDetails"));
          console.log(JSON.parse(localStorage.getItem("productDetails")));
          delete storage[name];
          localStorage.setItem("productDetails", JSON.stringify(storage));
          console.log(JSON.parse(localStorage.getItem("productDetails")));
        });
      });
    </script>
  </body>
</html>
